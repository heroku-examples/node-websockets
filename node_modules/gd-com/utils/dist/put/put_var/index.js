"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.putVar = void 0;
var constants_1 = require("../../constants");
var null_1 = require("./null");
var bool_1 = require("./bool");
var integer_1 = require("./integer");
var float_1 = require("./float");
var string_1 = require("./string");
var vector2_1 = require("./vector2");
var rect2_1 = require("./rect2");
var vector3_1 = require("./vector3");
var aabb_1 = require("./aabb");
var color_1 = require("./color");
var dictionnary_1 = require("./dictionnary");
var array_1 = require("./array");
var rawArray_1 = require("./rawArray");
var quat_1 = require("./quat");
var plane_1 = require("./plane");
var encoderList = (_a = {},
    _a[constants_1.TYPE.NULL] = null_1.putVarNull,
    _a[constants_1.TYPE.BOOL] = bool_1.putVarBool,
    _a[constants_1.TYPE.INTEGER] = integer_1.putVarInt,
    _a[constants_1.TYPE.FLOAT] = float_1.putVarFloat,
    _a[constants_1.TYPE.STRING] = string_1.putVarString,
    _a[constants_1.TYPE.VECTOR2] = vector2_1.putVarVector2,
    _a[constants_1.TYPE.RECT2] = rect2_1.putVarRect2,
    _a[constants_1.TYPE.VECTOR3] = vector3_1.putVarVector3,
    _a[constants_1.TYPE.TRANSFORM2D] = undefined,
    _a[constants_1.TYPE.PLANE] = plane_1.putVarPlane,
    _a[constants_1.TYPE.QUAT] = quat_1.putVarQuat,
    _a[constants_1.TYPE.AABB] = aabb_1.putVarAABB,
    _a[constants_1.TYPE.BASIS] = undefined,
    _a[constants_1.TYPE.TRANSFORM] = undefined,
    _a[constants_1.TYPE.COLOR] = color_1.putVarColor,
    _a[constants_1.TYPE.NODE_PATH] = undefined,
    _a[constants_1.TYPE.RID] = undefined,
    _a[constants_1.TYPE.OBJECT] = undefined,
    _a[constants_1.TYPE.DICTIONARY] = dictionnary_1.putVarDictionnary,
    _a[constants_1.TYPE.ARRAY] = array_1.putVarArray,
    _a[constants_1.TYPE.RAW_ARRAY] = rawArray_1.putVarRawArray,
    _a[constants_1.TYPE.INT_ARRAY] = undefined,
    _a[constants_1.TYPE.REAL_ARRAY] = undefined,
    _a[constants_1.TYPE.STRING_ARRAY] = undefined,
    _a[constants_1.TYPE.VECTOR2_ARRAY] = undefined,
    _a[constants_1.TYPE.VECTOR3_ARRAY] = undefined,
    _a[constants_1.TYPE.COLOR_ARRAY] = undefined,
    _a);
function getType(value) {
    if (value == null) {
        return constants_1.TYPE.NULL;
    }
    if (typeof value === "boolean") {
        return constants_1.TYPE.BOOL;
    }
    if (typeof value === "number") {
        if (Number.isInteger(value)) {
            return constants_1.TYPE.INTEGER;
        }
        return constants_1.TYPE.FLOAT;
    }
    if (typeof value === "string") {
        return constants_1.TYPE.STRING;
    }
    if (Array.isArray(value)) {
        return constants_1.TYPE.ARRAY;
    }
    if (typeof value === 'object') {
        if (value instanceof Buffer) {
            return constants_1.TYPE.RAW_ARRAY;
        }
        return constants_1.TYPE.DICTIONARY;
    }
    throw new Error("You should specify type");
}
function prepare(value, type) {
    var typeCode = type || getType(value);
    var encoder = encoderList["".concat(typeCode)];
    if (!encoder) {
        throw new Error("Invalid value: no matching encoder found \"".concat(typeCode, "\""));
    }
    return encoder(prepare, value);
}
/**
 * Encode Variant
 * By default it can Number, Array, Object, Null, String for complex type you need to pass the type
 * @param {*} value
 * @param {TYPE} type
 * @returns {*}
 */
function putVar(value, type) {
    return prepare(value, type);
}
exports.putVar = putVar;
