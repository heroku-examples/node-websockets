"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.putVarArray = void 0;
var constants_1 = require("../../constants");
/**
 * Encode array
 * @param value
 * @returns {Buffer}
 */
function subPutVarArray(value) {
    var len = 8;
    for (var i in value) {
        if (Object.prototype.hasOwnProperty.call(value, i)) {
            len += value[i].length;
        }
    }
    var buf = Buffer.alloc(len);
    buf.writeUInt16LE(constants_1.TYPE.ARRAY, 0);
    buf.writeUInt16LE(value.length & 0x7FFFFFFF, 4);
    var bufPos = 8;
    for (var i in value) {
        if (Object.prototype.hasOwnProperty.call(value, i)) {
            value[i].copy(buf, bufPos);
            bufPos += value[i].length;
        }
    }
    return buf;
}
function putVarArray(prepare, array) {
    var results = array.reduce(function (rawData, item) {
        var data = prepare(item);
        rawData.push(data);
        return rawData;
    }, []);
    return subPutVarArray(results);
}
exports.putVarArray = putVarArray;
