"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.putVarDictionnary = void 0;
var constants_1 = require("../../constants");
/**
 * Encode dictionnary
 * @param value
 * @returns {Buffer}
 */
function subPutVarDictionnary(value) {
    var len = 8;
    for (var i in value) {
        if (Object.prototype.hasOwnProperty.call(value, i)) {
            len += value[i].length;
        }
    }
    var buf = Buffer.alloc(len);
    buf.writeUInt16LE(constants_1.TYPE.DICTIONARY, 0);
    buf.writeUInt32LE((value.length / 2) & 0x7FFFFFFF, 4);
    var bufPos = 8;
    for (var i in value) {
        if (Object.prototype.hasOwnProperty.call(value, i)) {
            value[i].copy(buf, bufPos);
            bufPos += value[i].length;
        }
    }
    return buf;
}
var putVarDictionnary = function (prepare, dictionary) {
    var results = Object.keys(dictionary).reduce(function (rawData, key) {
        var rawKey = prepare(key);
        var rawValue = prepare(dictionary[key]);
        rawData.push(rawKey, rawValue);
        return rawData;
    }, []);
    return subPutVarDictionnary(results);
};
exports.putVarDictionnary = putVarDictionnary;
