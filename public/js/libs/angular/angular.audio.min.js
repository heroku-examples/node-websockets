"use strict";angular.module("ngAudio",[]).directive("ngAudio",["$compile","$q","ngAudio",function(e,t,n){return{restrict:"AEC",scope:{volume:"=",start:"=",currentTime:"=",loop:"=",clickPlay:"=",disablePreload:"="},controller:["$scope","$attrs","$element","$timeout",function(e,t,o,i){function r(){u=n.load(t.ngAudio,e),e.$audio=u,u.unbind()}var u;e.disablePreload||r(),o.on("click",function(){e.clickPlay!==!1&&(e.disablePreload&&r(),u.audio.play(),u.volume=e.volume||u.volume,u.loop=e.loop,u.currentTime=e.start||0,i(function(){u.play()},5))}),o.on("$destroy",function(){u.destroy()})}]}}]).directive("ngAudioHover",["$compile","$q","ngAudio",function(e,t,n){return{restrict:"AEC",controller:["$scope","$attrs","$element","$timeout",function(e,t,o,i){var r=n.load(t.ngAudioHover,e);o.on("mouseover rollover hover",function(){r.audio.play(),r.volume=t.volumeHover||r.volume,r.loop=t.loop,r.currentTime=t.startHover||0}),o.on("$destroy",function(){r.destroy()})}]}}]).service("localAudioFindingService",["$q",function(e){this.find=function(t){var n=e.defer(),o=document.getElementById(t);return o?n.resolve(o):n.reject(t),n.promise}}]).service("remoteAudioFindingService",["$q",function(e){this.find=function(t){var n=e.defer(),o=new Audio;return o.addEventListener("error",function(){n.reject()}),o.addEventListener("loadstart",function(){n.resolve(o)}),setTimeout(function(){o.src=t},1),n.promise}}]).service("cleverAudioFindingService",["$q","localAudioFindingService","remoteAudioFindingService",function(e,t,n){this.find=function(o){var i=e.defer();return o=o.replace("|","/"),t.find(o).then(i.resolve,function(){return n.find(o)}).then(i.resolve,i.reject),i.promise}}]).value("ngAudioGlobals",{muting:!1,performance:25,unlock:!0,volume:1}).factory("NgAudioObject",["cleverAudioFindingService","$rootScope","$interval","$timeout","ngAudioGlobals",function(e,t,n,o,i){return function(o,r){function u(){g.play(),g.pause(),window.removeEventListener("click",u)}function c(){T||(M&&n.cancel(M),m&&m(),s&&s(),T=!0)}function l(){T||(s=k.$watch(function(){return{volume:S.volume,currentTime:S.currentTime,progress:S.progress,muting:S.muting,loop:S.loop,playbackRate:S.playbackRate,globalVolume:i.volume}},function(e,t){e.currentTime!==t.currentTime&&S.setCurrentTime(e.currentTime),e.progress!==t.progress&&S.setProgress(e.progress),e.volume!==t.volume&&S.setVolume(e.volume),e.playbackRate!==t.playbackRate&&S.setPlaybackRate(e.playbackRate),e.globalVolume!==t.globalVolume&&(0===e.globalVolume?S.setMuting(!0):(S.setMuting(!1),S.setVolume(e.globalVolume))),f=e.loop,e.muting!==t.muting&&S.setMuting(e.muting)},!0))}function a(){if(s&&s(),g){if($||i.muting?g.volume=0:g.volume=void 0!==S.volume?S.volume:1,v&&(g.play(),v=!1),h&&(g.src="about:blank",h=!1),p&&(g.pause(),p=!1),y&&(g.playbackRate=b,y=!1),d&&(g.volume=d,d=void 0),A){S.currentTime=g.currentTime,S.duration=g.duration,S.remaining=g.duration-g.currentTime,S.progress=0,S.paused=g.paused,S.src=g.src;var e=g.currentTime/g.duration;e>0&&(S.progress=e),S.currentTime>=S.duration&&w.forEach(function(e){e(S)}),f&&S.currentTime>=S.duration&&(f!==!0&&(f--,S.loop--),S.setCurrentTime(0),S.play())}$||i.muting||(S.volume=g.volume),S.audio=g}l()}var s,m,d,f,g,v=!1,p=!1,h=!1,y=!1,b=!1,$=!1,A=!0,T=!1,k=r||t,S=this;this.id=o,this.safeId=o.replace("/","|"),this.loop=0,this.unbind=function(){A=!1},this.play=function(){return v=!0,this};var w=[];this.complete=function(e){w.push(e)},this.pause=function(){p=!0},this.restart=function(){h=!0},this.stop=function(){this.restart()},this.setVolume=function(e){d=e},this.setPlaybackRate=function(e){b=e,y=!0},this.setMuting=function(e){$=e},this.setProgress=function(e){g&&g.duration&&isFinite(e)&&(g.currentTime=g.duration*e)},this.setCurrentTime=function(e){g&&g.duration&&(g.currentTime=e)},this.destroy=c,k.$on("$destroy",function(){c()}),e.find(o).then(function(e){g=e,i.unlock&&(window.addEventListener("click",u),g.addEventListener("playing",function(){window.removeEventListener("click",u)})),g.addEventListener("canplay",function(){S.canPlay=!0})},function(e){S.error=!0,console.warn(e)});var M=n(a,i.performance);m=k.$watch(function(){return i.performance},function(){n.cancel(M),M=n(a,i.performance)})}}]).service("ngAudio",["NgAudioObject","ngAudioGlobals",function(e,t){this.play=function(t,n){var o=new e(t,n);return o.play(),o},this.load=function(t,n){return new e(t,n)},this.mute=function(){t.muting=!0},this.unmute=function(){t.muting=!1},this.toggleMute=function(){t.muting=!t.muting},this.setUnlock=function(e){t.unlock=e},this.setGlobalVolume=function(e){t.volume=e}}]).filter("trackTime",function(){return function(e){var t=Math.floor(0|e),n="",o=0,i=0,r=0;return t>3599?(o=Math.floor(t/3600),i=Math.floor((t-3600*o)/60),r=t-(60*i+3600*o),1==o.toString().length&&(o="0"+Math.floor(t/3600).toString()),1==i.toString().length&&(i="0"+Math.floor((t-3600*o)/60).toString()),1==r.toString().length&&(r="0"+(t-(60*i+3600*o)).toString()),n=o+":"+i+":"+r):t>59?(i=Math.floor(t/60),r=t-60*i,1==i.toString().length&&(i="0"+Math.floor(t/60).toString()),1==r.toString().length&&(r="0"+(t-60*i).toString()),n=i+":"+r):(r=t,1==r.toString().length&&(r="0"+t.toString()),n=t+"s"),"function"==typeof Number.isNaN&&Number.isNaN(n),n}});
//# sourceMappingURL=./angular.audio.min.js.map